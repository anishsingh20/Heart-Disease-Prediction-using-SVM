---
title: "Heart disease prediction using SVM"
author: "Anish Singh Walia"
date: "11 march 2018"
output:
  html_document:
    df_print: paged
---


## Prediction of heart disease

### Aim of analysis

In the following document, I will be using SVM classification techinque to predict heart disease (angiographic disease status). From a set of 14 variables, the most important to predict heart failure are whether or not there is a reversable defect in Thalassemia followed by whether or not there is an occurrence of asymptomatic chest pain.


## Dataset:


The heart disease data are available at UCI The description of the database can be found [here](https://archive.ics.uci.edu/ml/machine-learning-databases/heart-disease/).



let's read the dataset from the URL in R.

```{r}

heartdf <- read.csv("https://archive.ics.uci.edu/ml/machine-learning-databases/heart-disease/processed.cleveland.data",header=FALSE,sep=",",na.strings = '?')


names(heartdf) <- c( "age", "sex", "cp", "trestbps", "chol","fbs", "restecg",
                   "thalach","exang", "oldpeak","slope", "ca", "thal", "num")

```

The variable we want to predict is num with Value 0: < 50% diameter narrowing and Value 1: > 50% diameter narrowing. We assume that every value with 0 means heart is okay, and 1,2,3,4 means heart disease.

From the possible values the variables can take, it is evident that the following need to be dummified because the distances in the values is random: cp,thal, restecg, slope

Let's get a quick idea of data


```{r}

head(heartdf,3)

dim(heartdf)# dimensions of the dataset

```


Let's explore the data and find how many had heart attacks, women or men have of a particular age?

Let's first convert the dependent(class variable) $Y-num$ to binary variable.  


```{r}
#converting the num variable to binary class variable 

heartdf$num<-ifelse(heartdf$num > 0,"have heart disease","no heart disease")

table(heartdf$num)

#distribution of the target variable
ggplot(heartdf,aes(x = num)) +
  geom_bar(fill="black")



#converting to factor variable
heartdf$sex<-ifelse(heartdf$sex==0,"female","male")

table(heartdf$sex)


table(sex=heartdf$sex,disease=heartdf$num)

ggplot(heartdf,aes(x=sex)) +
  geom_bar(fill="purple") +
  facet_wrap(~num)


```


